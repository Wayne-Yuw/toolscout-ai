# ToolScout AI - 管理员后台系统设计

## 📋 文档信息

| 项目名称 | ToolScout AI - 管理员后台系统 |
|---------|------------------------------|
| 版本号 | v1.0 |
| 编写日期 | 2025-11-07 |
| 文档状态 | 设计中 |

---

## 🎯 系统设计目标

### 核心功能
1. **用户管理** - 用户增删改查、会员等级管理、账号状态管理
2. **系统配置** - AI模型配置、功能开关、限流配置
3. **数据统计** - 用户分析、使用统计、收入报表
4. **内容审核** - 用户生成内容审核、举报处理
5. **运营工具** - 优惠码管理、公告管理、邮件群发

### 权限设计原则
- **超级管理员**: 拥有所有权限
- **运营管理员**: 用户管理、内容审核、运营工具
- **技术管理员**: 系统配置、API管理、日志查询
- **数据分析员**: 只读权限,查看统计数据

---

## 🏗️ 系统架构

```
┌─────────────────────────────────────────────────────────┐
│                  管理员后台入口                           │
│                                                          │
│         🔐 管理员登录 (独立认证系统)                      │
│            - 用户名密码登录                              │
│            - 双因素认证(2FA)                             │
│            - IP白名单限制                                │
└─────────────────────────────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────┐
│                    权限验证层                             │
│                                                          │
│  - RBAC权限模型                                         │
│  - 操作审计日志                                         │
│  - 敏感操作二次确认                                      │
└─────────────────────────────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────┐
│                   功能模块层                             │
│                                                          │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐            │
│  │用户管理  │  │系统配置  │  │数据统计  │            │
│  └──────────┘  └──────────┘  └──────────┘            │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐            │
│  │内容审核  │  │运营工具  │  │日志查询  │            │
│  └──────────┘  └──────────┘  └──────────┘            │
└─────────────────────────────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────┐
│                   数据访问层                             │
│                                                          │
│  - API Gateway                                          │
│  - 数据库(主从分离)                                      │
│  - Redis缓存                                            │
└─────────────────────────────────────────────────────────┘
```

---

## 👥 模块一: 用户管理

### 1. 用户列表页面

```
┌─────────────────────────────────────────────────────────────────┐
│  用户管理                                    [+ 新增用户]        │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  筛选条件:                                                       │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐         │
│  │会员等级  │ │账号状态  │ │注册时间  │ │  [搜索]  │         │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘         │
│                                                                  │
│  搜索: [________________]  按用户名/手机号/邮箱搜索              │
│                                                                  │
│  ┌────────────────────────────────────────────────────────┐   │
│  │ ID  │用户名 │手机号    │会员等级│状态  │注册时间│操作  │   │
│  ├────────────────────────────────────────────────────────┤   │
│  │12345│user1 │138***1234│专业版 │正常 │2025-01-15│[编辑]│   │
│  │     │      │          │       │     │          │[删除]│   │
│  │     │      │          │       │     │          │[详情]│   │
│  ├────────────────────────────────────────────────────────┤   │
│  │12346│user2 │139***5678│基础版 │正常 │2025-02-20│[编辑]│   │
│  │     │      │          │       │     │          │[删除]│   │
│  │     │      │          │       │     │          │[详情]│   │
│  ├────────────────────────────────────────────────────────┤   │
│  │12347│user3 │136***9012│免费版 │封禁 │2025-03-10│[编辑]│   │
│  │     │      │          │       │     │          │[删除]│   │
│  │     │      │          │       │     │          │[详情]│   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  共 1,234 条记录  [1] [2] [3] ... [50]  每页显示: [20条]       │
│                                                                  │
│  批量操作: [导出Excel] [批量封禁] [批量删除]                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 2. 用户详情/编辑页面

```
┌─────────────────────────────────────────────────────────────────┐
│  用户详情 - user1 (ID: 12345)                    [返回列表]     │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  📊 基本信息                                                     │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  用户名:     user1                            [编辑]    │   │
│  │  手机号:     138****1234                      [修改]    │   │
│  │  邮箱:       user1@example.com                [验证]    │   │
│  │  昵称:       工具测评达人                               │   │
│  │  头像:       [显示头像缩略图]                 [更换]    │   │
│  │  注册时间:   2025-01-15 14:30:25                       │   │
│  │  最后登录:   2025-11-07 09:15:43                       │   │
│  │  登录次数:   156次                                      │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  💎 会员信息                                                     │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  当前等级:   🌟 专业版                                  │   │
│  │  到期时间:   2025-12-31 23:59:59                       │   │
│  │  自动续费:   ✓ 已开启                                  │   │
│  │  订阅时长:   已订阅 320 天                              │   │
│  │  累计消费:   ¥998                                      │   │
│  │                                                         │   │
│  │  [修改会员等级] [延长会员时间] [查看订阅历史]          │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  📈 使用统计                                                     │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  工具分析:   累计 1,234 次  |  本月 156 次             │   │
│  │  文案生成:   累计 3,567 次  |  本月 423 次             │   │
│  │  导出记录:   累计 456 次    |  本月 52 次              │   │
│  │  API调用:    累计 8,901 次  |  本月 1,203 次           │   │
│  │                                                         │   │
│  │  [查看详细统计]                                         │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  🔐 账号安全                                                     │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  账号状态:   ✓ 正常                                    │   │
│  │  手机验证:   ✓ 已验证                                  │   │
│  │  邮箱验证:   ✓ 已验证                                  │   │
│  │  OAuth绑定:  Google, GitHub                           │   │
│  │                                                         │   │
│  │  [重置密码] [封禁账号] [解除绑定] [查看登录日志]       │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  ⚠️ 危险操作区                                                  │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  [删除账号] [清空数据] [强制下线]                       │   │
│  │                                                         │   │
│  │  ⚠️ 这些操作不可恢复,请谨慎操作!                        │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 3. 用户操作功能

#### 3.1 新增用户
```
功能               实现逻辑                       验证规则
───────────────────────────────────────────────────────────
手动创建          • 管理员输入基本信息            ✓ 手机号唯一
                  • 系统生成临时密码              ✓ 用户名唯一
                  • 发送通知短信/邮件            ✓ 邮箱格式

初始密码          • 随机生成8位密码              ✓ 包含字母+数字
                  • 用户首次登录强制修改          ✓ 通过短信/邮件发送

初始会员等级      • 默认免费版                   ✓ 可手动指定
                  • 可设置试用期                  ✓ 试用期7-30天
```

#### 3.2 编辑用户
```
可编辑字段         权限要求                       操作记录
───────────────────────────────────────────────────────────
基本信息          • 运营管理员以上                ✓ 记录修改前后值
  - 昵称                                         ✓ 记录操作人
  - 头像                                         ✓ 记录操作时间
  - 个人简介

联系方式          • 超级管理员                    ✓ 需要二次确认
  - 手机号                                       ✓ 发送通知给用户
  - 邮箱                                         ✓ 记录审计日志

会员信息          • 运营管理员以上                ✓ 需要填写原因
  - 会员等级                                     ✓ 记录详细日志
  - 到期时间
  - 自动续费

账号状态          • 超级管理员                    ✓ 必须填写原因
  - 正常/封禁                                    ✓ 通知用户
  - 删除标记                                     ✓ 不可逆操作需确认
```

#### 3.3 重置密码
```
操作流程:
1. 管理员点击"重置密码"
2. 系统生成随机密码(8位)
3. 可选发送方式:
   - 短信发送到用户手机
   - 邮件发送到用户邮箱
   - 仅显示给管理员(由管理员转告)
4. 记录操作日志
5. 用户下次登录强制修改密码

安全措施:
• 敏感操作,需要二次确认
• 记录管理员操作日志
• 通知用户密码已被重置
```

#### 3.4 设置会员等级
```
操作选项:
┌────────────────────────────────────────┐
│  修改会员等级                           │
├────────────────────────────────────────┤
│                                        │
│  当前等级: 基础版                      │
│  到期时间: 2025-12-31                  │
│                                        │
│  新等级: [下拉选择]                    │
│  ○ 免费版                              │
│  ○ 基础版 (¥29/月)                    │
│  ● 专业版 (¥99/月)  ← 选中            │
│  ○ 企业版 (¥499/月)                   │
│                                        │
│  有效期: [日期选择器]                  │
│  □ 永久有效                            │
│                                        │
│  操作原因: [必填]                      │
│  ┌──────────────────────────────┐    │
│  │ 示例: 补偿用户 / 测试账号等   │    │
│  │ _____________________________│    │
│  │                              │    │
│  └──────────────────────────────┘    │
│                                        │
│  通知方式:                             │
│  ☑ 发送短信通知                        │
│  ☑ 发送邮件通知                        │
│  □ 站内消息通知                        │
│                                        │
│       [确认修改]    [取消]             │
│                                        │
└────────────────────────────────────────┘

业务规则:
• 升级立即生效
• 降级在当前周期结束后生效
• 可设置补偿性会员(免费赠送)
• 记录详细的操作日志
```

#### 3.5 账号封禁/解封
```
封禁流程:
┌────────────────────────────────────────┐
│  封禁账号 - user1                      │
├────────────────────────────────────────┤
│                                        │
│  封禁原因: [必选]                      │
│  ○ 违反用户协议                        │
│  ● 发布违法内容  ← 选中                │
│  ○ 恶意刷单                            │
│  ○ 其他原因                            │
│                                        │
│  详细说明: [必填]                      │
│  ┌──────────────────────────────┐    │
│  │ 用户发布了包含违禁词的内容     │    │
│  │ 经审核确认违规                │    │
│  │                              │    │
│  └──────────────────────────────┘    │
│                                        │
│  封禁时长:                             │
│  ○ 临时封禁 (7天)                      │
│  ○ 临时封禁 (30天)                     │
│  ● 永久封禁  ← 选中                   │
│                                        │
│  后续处理:                             │
│  ☑ 清空用户历史记录                    │
│  ☑ 删除用户生成内容                    │
│  ☑ 退还未使用会员费                    │
│  ☑ 发送封禁通知邮件                    │
│                                        │
│  ⚠️ 此操作将立即生效,用户无法登录       │
│                                        │
│       [确认封禁]    [取消]             │
│                                        │
└────────────────────────────────────────┘

封禁效果:
• 账号标记为 suspended
• 所有 token 失效
• 无法登录
• 历史数据保留(除非选择删除)
• 会员自动续费停止
```

#### 3.6 删除账号
```
删除流程:
┌────────────────────────────────────────┐
│  ⚠️ 删除账号 - user1                   │
├────────────────────────────────────────┤
│                                        │
│  此操作非常危险且不可恢复!              │
│                                        │
│  将删除以下数据:                        │
│  • 用户基本信息                         │
│  • 会员订阅记录                         │
│  • 工具分析历史                         │
│  • 生成的文案内容                       │
│  • OAuth绑定关系                       │
│                                        │
│  将保留以下数据:                        │
│  • 订单交易记录 (财务审计需要)          │
│  • 操作日志 (安全审计需要)              │
│                                        │
│  删除原因: [必填]                       │
│  ┌──────────────────────────────┐    │
│  │ 用户申请注销账号               │    │
│  │                              │    │
│  └──────────────────────────────┘    │
│                                        │
│  二次确认:                             │
│  请输入用户手机号后4位: [____]          │
│                                        │
│  管理员密码验证: [__________]           │
│                                        │
│       [确认删除]    [取消]             │
│                                        │
└────────────────────────────────────────┘

安全措施:
• 需要输入用户手机号后4位确认
• 需要输入管理员密码
• 记录详细的删除日志
• 部分关键数据软删除(标记deleted=true)
• 30天内可恢复,30天后物理删除
```

---

## ⚙️ 模块二: 系统配置

### 1. AI模型配置

```
┌─────────────────────────────────────────────────────────────────┐
│  AI模型配置                                  [保存配置]          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  🤖 主模型配置                                                   │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  模型提供商: [下拉选择]                                 │   │
│  │  ● OpenAI                                              │   │
│  │  ○ Azure OpenAI                                        │   │
│  │  ○ Anthropic (Claude)                                  │   │
│  │  ○ Google (PaLM/Gemini)                                │   │
│  │  ○ 自建模型                                            │   │
│  │                                                         │   │
│  │  API Key: [********************************]  [测试连接]│   │
│  │                                                         │   │
│  │  模型版本:                                              │   │
│  │  • 工具分析:    gpt-4-turbo-preview                    │   │
│  │  • 文案生成:    gpt-4                                  │   │
│  │  • 人群拆解:    gpt-3.5-turbo-16k                      │   │
│  │                                                         │   │
│  │  参数配置:                                              │   │
│  │  • Temperature:     [0.7]   (创造性: 0.0 ~ 1.0)       │   │
│  │  • Max Tokens:      [4000]                             │   │
│  │  • Top P:           [0.9]                              │   │
│  │  • Frequency Penalty: [0.0]                            │   │
│  │                                                         │   │
│  │  [高级配置]                                             │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  💰 成本控制                                                     │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  每日最大调用次数:    [10000] 次                       │   │
│  │  每日最大花费:        [$100.00]                        │   │
│  │                                                         │   │
│  │  超限处理:                                              │   │
│  │  ○ 停止服务                                            │   │
│  │  ● 降级为备用模型                                      │   │
│  │  ○ 发送告警邮件                                        │   │
│  │                                                         │   │
│  │  当前使用情况:                                          │   │
│  │  • 今日调用: 3,456 / 10,000 次                         │   │
│  │  • 今日花费: $32.15 / $100.00                          │   │
│  │  • 预计月度: $965.00                                   │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  🔄 备用模型配置                                                 │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  启用备用模型: ☑ 是                                     │   │
│  │                                                         │   │
│  │  备用提供商:   Claude (Anthropic)                      │   │
│  │  API Key:      [********************************]      │   │
│  │  模型版本:     claude-3-opus-20240229                  │   │
│  │                                                         │   │
│  │  切换条件:                                              │   │
│  │  ☑ 主模型不可用时                                       │   │
│  │  ☑ 主模型响应超时(>30s)                                │   │
│  │  ☑ 主模型达到配额限制                                   │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  📊 Prompt模板管理                                              │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  工具分析Prompt:       [编辑] [测试] [版本历史]        │   │
│  │  人群拆解Prompt:       [编辑] [测试] [版本历史]        │   │
│  │  文案生成Prompt:       [编辑] [测试] [版本历史]        │   │
│  │  同类推荐Prompt:       [编辑] [测试] [版本历史]        │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 2. 功能开关配置

```
┌─────────────────────────────────────────────────────────────────┐
│  功能开关管理                                [批量操作]          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  核心功能                                                        │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  [🟢] 工具搜索功能              启用  [禁用]            │   │
│  │  [🟢] URL直接分析               启用  [禁用]            │   │
│  │  [🟢] 人群拆解功能              启用  [禁用]            │   │
│  │  [🟢] 文案生成功能              启用  [禁用]            │   │
│  │  [🔴] 同类工具推荐              禁用  [启用]  ← 维护中   │   │
│  │  [🟢] 历史记录功能              启用  [禁用]            │   │
│  │  [🟢] 多格式导出                启用  [禁用]            │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  高级功能                                                        │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  [🟡] 自定义文案风格            限制  [全量开放]        │   │
│  │      └ 仅对专业版及以上开放                            │   │
│  │                                                         │   │
│  │  [🟢] API调用权限               启用  [禁用]            │   │
│  │      └ 根据会员等级控制配额                            │   │
│  │                                                         │   │
│  │  [🔴] 批量分析功能              禁用  [启用]            │   │
│  │      └ 功能开发中                                      │   │
│  │                                                         │   │
│  │  [🟢] 团队协作功能              启用  [禁用]            │   │
│  │      └ 仅企业版可用                                    │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  第三方集成                                                      │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  [🟢] Google OAuth登录         启用  [禁用]            │   │
│  │  [🟢] GitHub OAuth登录         启用  [禁用]            │   │
│  │  [🔴] 微信登录                  禁用  [启用]  ← 未配置   │   │
│  │  [🟢] 支付宝支付                启用  [禁用]            │   │
│  │  [🟢] 微信支付                  启用  [禁用]            │   │
│  │  [🟢] PayPal支付                启用  [禁用]            │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  维护模式                                                        │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  [🔴] 全站维护模式              禁用  [启用]            │   │
│  │                                                         │   │
│  │  维护公告: [文本框]                                     │   │
│  │  预计恢复时间: [日期时间选择器]                         │   │
│  │                                                         │   │
│  │  白名单用户: (维护期间仍可访问)                         │   │
│  │  [admin@example.com, test@example.com]                │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 3. 限流与配额配置

```
┌─────────────────────────────────────────────────────────────────┐
│  限流配置                                    [应用配置]          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  全局限流                                                        │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  IP级别限流:                                            │   │
│  │  • 每秒请求数:    [100] QPS                            │   │
│  │  • 每分钟请求数:  [1000] QPM                           │   │
│  │  • 每小时请求数:  [10000] QPH                          │   │
│  │                                                         │   │
│  │  触发限流后:                                            │   │
│  │  ○ 返回 429 错误                                       │   │
│  │  ● 进入队列等待                                        │   │
│  │  ○ 直接拒绝                                            │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  会员等级限流                                                    │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  免费版:                                                │   │
│  │  • 工具分析:     3次/天                                │   │
│  │  • API调用:      0次/天 (不开放)                       │   │
│  │  • 导出功能:     10次/天                               │   │
│  │                                                         │   │
│  │  基础版 (¥29/月):                                      │   │
│  │  • 工具分析:     20次/天                               │   │
│  │  • API调用:      100次/天                              │   │
│  │  • 导出功能:     50次/天                               │   │
│  │                                                         │   │
│  │  专业版 (¥99/月):                                      │   │
│  │  • 工具分析:     无限制                                │   │
│  │  • API调用:      1000次/天                             │   │
│  │  • 导出功能:     无限制                                │   │
│  │                                                         │   │
│  │  企业版 (¥499/月):                                     │   │
│  │  • 工具分析:     无限制                                │   │
│  │  • API调用:      10000次/天                            │   │
│  │  • 导出功能:     无限制                                │   │
│  │                                                         │   │
│  │  [自定义配额]                                           │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  AI调用限流                                                      │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  单用户:                                                │   │
│  │  • 工具分析:     10次/分钟                             │   │
│  │  • 文案生成:     20次/分钟                             │   │
│  │                                                         │   │
│  │  全局:                                                  │   │
│  │  • AI总调用:     1000次/分钟                           │   │
│  │  • 最大并发:     50个请求                              │   │
│  │                                                         │   │
│  │  成本保护:                                              │   │
│  │  • 单次调用最大token: 8000                             │   │
│  │  • 每日最大花费: $100                                  │   │
│  │  ☑ 超限时启用备用模型                                   │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 4. 第三方服务配置

```
┌─────────────────────────────────────────────────────────────────┐
│  第三方服务配置                              [测试连接]          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  📧 邮件服务                                                     │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  服务提供商: [下拉选择]                                 │   │
│  │  ● SendGrid                                            │   │
│  │  ○ 阿里云邮件推送                                       │   │
│  │  ○ 腾讯云邮件                                          │   │
│  │  ○ 自建SMTP                                            │   │
│  │                                                         │   │
│  │  API Key:  [********************************]          │   │
│  │  发件人:   noreply@toolscout.ai                        │   │
│  │  发件名:   ToolScout AI                                │   │
│  │                                                         │   │
│  │  每日限额: 10,000 封                                   │   │
│  │  已用额度: 3,234 / 10,000                              │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  📱 短信服务                                                     │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  服务提供商: [下拉选择]                                 │   │
│  │  ● 阿里云短信                                          │   │
│  │  ○ 腾讯云短信                                          │   │
│  │  ○ Twilio                                              │   │
│  │                                                         │   │
│  │  AccessKey ID:     [********************]             │   │
│  │  AccessKey Secret: [********************]             │   │
│  │  签名:             【ToolScout AI】                    │   │
│  │  模板ID:           SMS_123456789                       │   │
│  │                                                         │   │
│  │  每日限额: 1,000 条                                    │   │
│  │  已用额度: 234 / 1,000                                 │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  💳 支付服务                                                     │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  微信支付:                                              │   │
│  │  • AppID:      [******************]                    │   │
│  │  • MchID:      [******************]                    │   │
│  │  • API密钥:    [******************]                    │   │
│  │  • 状态:       ✓ 已启用                                │   │
│  │                                                         │   │
│  │  支付宝:                                                │   │
│  │  • AppID:      [******************]                    │   │
│  │  • 私钥:       [******************]                    │   │
│  │  • 公钥:       [******************]                    │   │
│  │  • 状态:       ✓ 已启用                                │   │
│  │                                                         │   │
│  │  PayPal:                                               │   │
│  │  • Client ID:  [******************]                    │   │
│  │  • Secret:     [******************]                    │   │
│  │  • 模式:       ● 生产环境  ○ 沙箱环境                  │   │
│  │  • 状态:       ✓ 已启用                                │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  🗄️ 对象存储                                                    │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  服务商: 阿里云 OSS                                     │   │
│  │  Bucket: toolscout-prod                                │   │
│  │  Region: cn-hangzhou                                   │   │
│  │  域名:   https://cdn.toolscout.ai                      │   │
│  │                                                         │   │
│  │  存储用量: 125.6 GB / 500 GB                           │   │
│  │  流量用量: 2.3 TB (本月)                               │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 📊 模块三: 数据统计与分析

### 1. 概览仪表盘

```
┌─────────────────────────────────────────────────────────────────┐
│  数据概览                        今日 | 本周 | 本月 | 自定义    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  核心指标 (今日)                                                 │
│  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌───────────┐      │
│  │   新增    │ │   活跃    │ │   付费    │ │   收入    │      │
│  │   用户    │ │   用户    │ │   转化    │ │   (CNY)   │      │
│  │           │ │           │ │           │ │           │      │
│  │   156     │ │  2,345    │ │   23      │ │  ¥2,987   │      │
│  │   ▲ 12%   │ │   ▼ 5%    │ │   ▲ 8%    │ │   ▲ 15%   │      │
│  └───────────┘ └───────────┘ └───────────┘ └───────────┘      │
│                                                                  │
│  用户增长趋势                                        [导出图表]  │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  3000 │                                                 │   │
│  │       │                                        ●        │   │
│  │  2000 │                           ●        ●            │   │
│  │       │               ●        ●                        │   │
│  │  1000 │        ●   ●                                    │   │
│  │       │     ●                                           │   │
│  │     0 └──────┬──────┬──────┬──────┬──────┬──────┬──    │   │
│  │            11/1   11/2   11/3   11/4   11/5   11/6   11/7│   │
│  │                                                         │   │
│  │  ── 总用户  ── 活跃用户  ── 付费用户                    │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  功能使用统计 (本月)                                             │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  工具分析:   43,567 次      [查看详情]                  │   │
│  │  ██████████████████████████████░░ 87% 环比增长          │   │
│  │                                                         │   │
│  │  文案生成:   89,234 次      [查看详情]                  │   │
│  │  ████████████████████████████████░ 92% 环比增长        │   │
│  │                                                         │   │
│  │  API调用:    125,678 次     [查看详情]                 │   │
│  │  ██████████████████████░░░░░░░░░░ 65% 环比增长         │   │
│  │                                                         │   │
│  │  导出文件:   23,456 次      [查看详情]                  │   │
│  │  █████████████████░░░░░░░░░░░░░░░ 54% 环比增长         │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  会员分布                                                        │
│  ┌────────────────────────────────────────────────────────┐   │
│  │                                                         │   │
│  │  [饼图显示]                                             │   │
│  │                                                         │   │
│  │  免费版: 12,345 人 (72.3%)                             │   │
│  │  基础版: 3,456 人  (20.2%)                             │   │
│  │  专业版: 1,123 人  (6.6%)                              │   │
│  │  企业版: 156 人    (0.9%)                              │   │
│  │                                                         │   │
│  │  总计: 17,080 人                                       │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 2. 收入报表

```
┌─────────────────────────────────────────────────────────────────┐
│  收入报表                        本月 | 本季 | 本年 | 自定义    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  本月收入概览 (2025-11)                                          │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  总收入:         ¥89,765                               │   │
│  │  订阅收入:       ¥78,234  (87.2%)                      │   │
│  │  新用户:         ¥11,531  (12.8%)                      │   │
│  │  续费:           ¥66,703  (74.4%)                      │   │
│  │                                                         │   │
│  │  退款:           ¥1,234   (1.4%)                       │   │
│  │  净收入:         ¥88,531                               │   │
│  │                                                         │   │
│  │  环比增长:       ▲ 23.5%                               │   │
│  │  同比增长:       ▲ 156.7%                              │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  分套餐收入明细                                                  │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  套餐     │ 数量  │ 单价  │ 收入    │ 占比   │ 环比    │   │
│  ├────────────────────────────────────────────────────────┤   │
│  │  基础版   │ 234   │ ¥29   │ ¥6,786  │ 7.6%   │ ▲15%   │   │
│  │  专业版   │ 567   │ ¥99   │ ¥56,133 │ 62.8%  │ ▲28%   │   │
│  │  企业版   │ 32    │ ¥499  │ ¥15,968 │ 17.9%  │ ▲45%   │   │
│  ├────────────────────────────────────────────────────────┤   │
│  │  合计     │ 833   │   -   │ ¥78,887 │ 100%   │ ▲26%   │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  支付方式分布                                                    │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  微信支付:    ¥45,678  (50.9%)                         │   │
│  │  支付宝:      ¥38,234  (42.6%)                         │   │
│  │  PayPal:      ¥5,853   (6.5%)                          │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  [导出Excel] [导出PDF] [发送邮件报表]                           │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🔍 模块四: 日志与审计

### 1. 操作日志

```
┌─────────────────────────────────────────────────────────────────┐
│  操作日志                                    [导出日志]          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  筛选:                                                           │
│  操作人: [全部管理员 ▼]  操作类型: [全部操作 ▼]                 │
│  时间范围: [2025-11-01] ~ [2025-11-07]    [查询]               │
│                                                                  │
│  ┌────────────────────────────────────────────────────────┐   │
│  │ 时间          │操作人│操作类型  │详情          │IP地址 │   │
│  ├────────────────────────────────────────────────────────┤   │
│  │ 11-07 14:23  │admin │修改会员  │将user123升级  │1.2.3.4│   │
│  │              │      │等级      │为专业版       │       │   │
│  │              │      │          │[查看详情]     │       │   │
│  ├────────────────────────────────────────────────────────┤   │
│  │ 11-07 13:15  │oper1 │重置密码  │重置user456的  │2.3.4.5│   │
│  │              │      │          │密码           │       │   │
│  │              │      │          │[查看详情]     │       │   │
│  ├────────────────────────────────────────────────────────┤   │
│  │ 11-07 12:05  │admin │封禁账号  │封禁user789,   │1.2.3.4│   │
│  │              │      │          │原因:违规内容  │       │   │
│  │              │      │          │[查看详情]     │       │   │
│  ├────────────────────────────────────────────────────────┤   │
│  │ 11-07 10:30  │tech1 │修改配置  │更新AI模型参数 │3.4.5.6│   │
│  │              │      │          │[查看详情]     │       │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  共 5,678 条记录  [1] [2] [3] ... [284]                         │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 2. 系统告警

```
┌─────────────────────────────────────────────────────────────────┐
│  系统告警                         [告警规则配置]                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ⚠️ 未处理告警 (3)                                              │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  🔴 严重 │ AI调用失败率异常                            │   │
│  │          │ 过去1小时失败率达到15%,超过阈值10%          │   │
│  │          │ 时间: 2025-11-07 14:30                     │   │
│  │          │ [查看详情] [标记已处理]                     │   │
│  ├────────────────────────────────────────────────────────┤   │
│  │  🟡 警告 │ 数据库连接数过高                            │   │
│  │          │ 当前连接数: 450/500                        │   │
│  │          │ 时间: 2025-11-07 14:25                     │   │
│  │          │ [查看详情] [标记已处理]                     │   │
│  ├────────────────────────────────────────────────────────┤   │
│  │  🟡 警告 │ 每日AI调用额度即将用完                      │   │
│  │          │ 已用: 9,523 / 10,000 次                    │   │
│  │          │ 时间: 2025-11-07 14:20                     │   │
│  │          │ [查看详情] [标记已处理]                     │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  ✅ 已处理告警 (今日12条)                      [查看历史]       │
│                                                                  │
│  告警规则                                                        │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  • API响应时间 > 3s            [启用]  阈值: [3]s      │   │
│  │  • 错误率 > 5%                  [启用]  阈值: [5]%      │   │
│  │  • 数据库连接数 > 80%           [启用]  阈值: [80]%     │   │
│  │  • 磁盘使用率 > 85%             [启用]  阈值: [85]%     │   │
│  │  • 每日花费 > $80               [启用]  阈值: [$80]     │   │
│  │  • 异常登录(异地/新设备)        [启用]                 │   │
│  │  • 密码错误次数 > 100/小时      [启用]  阈值: [100]    │   │
│  │                                                         │   │
│  │  [添加规则]                                             │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
│  通知方式                                                        │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  ☑ 站内通知                                             │   │
│  │  ☑ 邮件通知                                             │   │
│  │  ☑ 短信通知 (仅严重级别)                                │   │
│  │  □ 企业微信通知                                         │   │
│  │  □ 钉钉通知                                             │   │
│  │                                                         │   │
│  │  通知接收人:                                            │   │
│  │  admin@toolscout.ai, tech@toolscout.ai                │   │
│  │                                                         │   │
│  │  [编辑接收人]                                           │   │
│  └────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🔑 权限与安全设计

### 1. RBAC权限模型

```sql
-- 角色表
CREATE TABLE admin_roles (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL COMMENT '角色名称',
    code VARCHAR(50) UNIQUE NOT NULL COMMENT '角色代码',
    description TEXT COMMENT '角色描述',
    level INT DEFAULT 0 COMMENT '角色级别(数字越大权限越高)',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB COMMENT='管理员角色表';

-- 权限表
CREATE TABLE admin_permissions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL COMMENT '权限名称',
    code VARCHAR(100) UNIQUE NOT NULL COMMENT '权限代码',
    module VARCHAR(50) COMMENT '所属模块',
    action VARCHAR(50) COMMENT '操作类型',
    description TEXT COMMENT '权限描述',
    is_sensitive BOOLEAN DEFAULT FALSE COMMENT '是否敏感操作',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB COMMENT='权限表';

-- 角色-权限关联表
CREATE TABLE admin_role_permissions (
    role_id INT NOT NULL,
    permission_id INT NOT NULL,
    PRIMARY KEY (role_id, permission_id),
    FOREIGN KEY (role_id) REFERENCES admin_roles(id) ON DELETE CASCADE,
    FOREIGN KEY (permission_id) REFERENCES admin_permissions(id) ON DELETE CASCADE
) ENGINE=InnoDB COMMENT='角色权限关联表';

-- 管理员表
CREATE TABLE admin_users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    real_name VARCHAR(50) COMMENT '真实姓名',
    email VARCHAR(100),
    phone VARCHAR(20),

    role_id INT NOT NULL COMMENT '角色ID',

    -- 双因素认证
    two_factor_enabled BOOLEAN DEFAULT FALSE,
    two_factor_secret VARCHAR(100),

    -- 安全设置
    ip_whitelist TEXT COMMENT 'IP白名单(JSON数组)',
    login_allowed_time VARCHAR(100) COMMENT '允许登录时间段',

    status ENUM('active', 'suspended') DEFAULT 'active',

    last_login_at TIMESTAMP,
    last_login_ip VARCHAR(45),

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    FOREIGN KEY (role_id) REFERENCES admin_roles(id)
) ENGINE=InnoDB COMMENT='管理员用户表';

-- 操作日志表
CREATE TABLE admin_operation_logs (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    admin_id INT NOT NULL,
    admin_username VARCHAR(50),

    module VARCHAR(50) COMMENT '操作模块',
    action VARCHAR(100) COMMENT '操作类型',
    target_type VARCHAR(50) COMMENT '目标类型(user/config/etc)',
    target_id VARCHAR(100) COMMENT '目标ID',

    details JSON COMMENT '操作详情',
    before_data JSON COMMENT '修改前数据',
    after_data JSON COMMENT '修改后数据',

    ip_address VARCHAR(45),
    user_agent TEXT,

    status ENUM('success', 'failed') DEFAULT 'success',
    error_message TEXT,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_admin (admin_id),
    INDEX idx_module_action (module, action),
    INDEX idx_created_at (created_at),
    FOREIGN KEY (admin_id) REFERENCES admin_users(id)
) ENGINE=InnoDB COMMENT='管理员操作日志表';
```

### 2. 预设角色和权限

```
角色名称         级别  权限范围
────────────────────────────────────────────────────────
超级管理员       99    • 所有权限
Super Admin            • 管理其他管理员
                       • 修改系统核心配置
                       • 查看所有日志
                       • 删除关键数据

────────────────────────────────────────────────────────
运营管理员       50    • 用户管理 (增删改查)
Operations             • 会员等级管理
Manager               • 内容审核
                       • 优惠码管理
                       • 数据统计查看
                       • 公告管理

────────────────────────────────────────────────────────
技术管理员       50    • 系统配置管理
Technical              • AI模型配置
Manager               • 功能开关配置
                       • 限流配置
                       • 日志查询
                       • 告警管理

────────────────────────────────────────────────────────
客服人员         20    • 查看用户信息
Customer               • 查看订单信息
Service               • 处理用户工单
                       • 发送通知消息

────────────────────────────────────────────────────────
数据分析员       10    • 查看所有统计数据
Data Analyst          • 导出报表
                       • 查看用户行为数据
                       • 查看收入报表

────────────────────────────────────────────────────────
```

### 3. 敏感操作二次确认

```
敏感操作列表:
───────────────────────────────────────────
• 删除用户账号          需要输入管理员密码
• 修改用户手机号        需要二次确认
• 封禁/解封账号         需要填写原因
• 批量修改会员等级      需要二次确认
• 修改AI模型配置        需要输入管理员密码
• 修改支付配置          需要二次确认
• 导出用户敏感信息      需要审批流程
• 清空系统数据          需要多人确认
```

---

## 📝 接口设计(管理后台API)

### 1. 用户管理接口

```typescript
// 获取用户列表
GET /api/admin/users
Query Parameters:
  - page: number (页码)
  - pageSize: number (每页数量)
  - membership: string (会员等级筛选)
  - status: string (状态筛选)
  - keyword: string (搜索关键词)
  - startDate: string (注册开始日期)
  - endDate: string (注册结束日期)

Response:
{
  "success": true,
  "data": {
    "users": [...],
    "total": 1234,
    "page": 1,
    "pageSize": 20
  }
}

// 获取用户详情
GET /api/admin/users/:userId

// 更新用户信息
PUT /api/admin/users/:userId
Body:
{
  "nickname": "新昵称",
  "email": "new@example.com",
  "membership_level": "pro",
  "membership_expire_at": "2025-12-31",
  "reason": "操作原因"
}

// 重置用户密码
POST /api/admin/users/:userId/reset-password
Body:
{
  "notify_method": "sms", // sms | email | both
  "admin_password": "管理员密码确认"
}

// 封禁用户
POST /api/admin/users/:userId/suspend
Body:
{
  "reason": "封禁原因",
  "duration": 7, // 天数, -1表示永久
  "clear_data": false,
  "admin_password": "管理员密码确认"
}

// 删除用户
DELETE /api/admin/users/:userId
Body:
{
  "reason": "删除原因",
  "phone_verify": "1234", // 手机号后4位
  "admin_password": "管理员密码确认"
}
```

### 2. 系统配置接口

```typescript
// 获取AI模型配置
GET /api/admin/config/ai

// 更新AI模型配置
PUT /api/admin/config/ai
Body:
{
  "provider": "openai",
  "api_key": "sk-...",
  "models": {
    "analysis": "gpt-4-turbo",
    "generation": "gpt-4"
  },
  "parameters": {
    "temperature": 0.7,
    "max_tokens": 4000
  }
}

// 测试AI连接
POST /api/admin/config/ai/test

// 获取功能开关配置
GET /api/admin/config/features

// 更新功能开关
PUT /api/admin/config/features/:featureName
Body:
{
  "enabled": true,
  "config": { ... }
}

// 获取限流配置
GET /api/admin/config/rate-limits

// 更新限流配置
PUT /api/admin/config/rate-limits
```

### 3. 数据统计接口

```typescript
// 获取概览数据
GET /api/admin/stats/overview
Query: ?period=today|week|month

// 获取用户增长数据
GET /api/admin/stats/user-growth

// 获取收入报表
GET /api/admin/stats/revenue

// 获取功能使用统计
GET /api/admin/stats/feature-usage

// 导出报表
GET /api/admin/stats/export
Query:
  - type: users|revenue|usage
  - format: excel|pdf|csv
  - startDate: string
  - endDate: string
```

---

## 🚀 部署与安全建议

### 1. 独立部署
- 管理后台应与用户端分离部署
- 使用独立的域名(如 admin.toolscout.ai)
- 独立的服务器和数据库

### 2. 网络安全
- 仅允许特定IP访问(IP白名单)
- 强制HTTPS
- 配置WAF防火墙
- 启用DDoS防护

### 3. 认证安全
- 强制双因素认证(2FA)
- 密码复杂度要求
- 登录失败锁定机制
- Session超时自动登出

### 4. 审计与监控
- 所有操作必须记录日志
- 敏感操作实时告警
- 定期审计日志
- 异常行为检测

---

*文档完成*

## 附录

### A. 快速开始指南
1. 创建管理员账号
2. 配置AI模型
3. 设置会员套餐
4. 配置支付方式
5. 开启功能开关

### B. 常见问题
Q: 如何添加新管理员?
A: 超级管理员登录 → 系统设置 → 管理员管理 → 新增

Q: 如何修改用户会员等级?
A: 用户管理 → 选择用户 → 编辑 → 修改会员等级

### C. 联系支持
- 技术支持: support@toolscout.ai
- 紧急热线: +86 400-xxx-xxxx
